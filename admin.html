<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <title>LibModern - Admin Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="data.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@600;800&display=swap');

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background: #f8fafc;
        }

        /* Sidebar mÃ u nháº¡t hÆ¡n (Peach/Pastel Orange) */
        .sidebar-vibrant {
            background: linear-gradient(180deg, #FFB347 0%, #FFCC33 100%);
            box-shadow: 10px 0 30px rgba(255, 179, 71, 0.15);
        }

        /* áº¨n thanh scroll cho Chrome, Safari vÃ  Firefox */
        .no-scrollbar::-webkit-scrollbar {
            display: none;
        }

        .no-scrollbar {
            -ms-overflow-style: none;
            /* IE and Edge */
            scrollbar-width: none;
            /* Firefox */
        }

        /* Má»¥c menu máº·c Ä‘á»‹nh: Trong suá»‘t hoÃ n toÃ n */
        .nav-item {
            margin-bottom: 0.5rem;
            padding: 1rem 1.5rem;
            border-radius: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 700;
            transition: all 0.3s ease;
            cursor: pointer;
            background: transparent;
            /* Máº·c Ä‘á»‹nh khÃ´ng cÃ³ ná»n */
        }

        /* Hover: Chá»‰ thay Ä‘á»•i mÃ u chá»¯ vÃ  Ä‘á»™ sÃ¡ng, khÃ´ng hiá»‡n ná»n tráº¯ng */
        .nav-item:hover {
            color: #ffffff;
            padding-left: 1.8rem;
            background: rgba(255, 255, 255, 0.1);
            /* Ná»n má» cá»±c nháº¹ khi hover */
        }

        /* Active: Chá»‰ má»¥c nÃ y má»›i cÃ³ ná»n tráº¯ng */
        .nav-item.active {
            background: #ffffff !important;
            color: #FF8C00 !important;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.05);
            transform: scale(1.02);
        }

        .nav-item span {
            font-size: 1.25rem;
        }

        /* Ná»n vÃ¹ng Main: Gradient tá»« tráº¯ng sang cam cá»±c nháº¡t hoáº·c xanh nháº¡t */
        .main-vibrant-bg {
            background: linear-gradient(145deg, #f8fafc 0%, #fff5e6 50%, #f0f9ff 100%);
            background-attachment: fixed;
            /* Giá»¯ ná»n cá»‘ Ä‘á»‹nh khi cuá»™n */
        }

        /* ThÃªm má»™t chÃºt hiá»‡u á»©ng Ä‘á»• bÃ³ng cho tiÃªu Ä‘á» Ä‘á»ƒ báº¯t máº¯t hÆ¡n */
        .header-title {
            background: linear-gradient(to right, #1e293b, #FF8C00);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }
    </style>
    </style>
</head>

<body class="flex min-h-screen">

    <aside
        class="w-80 sidebar-vibrant m-4 rounded-[3rem] shadow-2xl flex flex-col p-6 h-[calc(100vh-2rem)] sticky top-4">
        <div class="mb-8 px-4 mt-2">
            <h1 class="text-2xl font-black text-white tracking-tighter flex items-center gap-2">
                <span class="p-2 bg-white rounded-xl text-orange-400 text-lg shadow-sm">L</span>
                LIB<span class="text-slate-900">MODERN</span>
            </h1>
        </div>

        <div class="bg-white/10 rounded-[2rem] p-5 mb-6 backdrop-blur-sm border border-white/20 text-center">
            <div
                class="w-14 h-14 bg-white rounded-2xl mx-auto mb-3 flex items-center justify-center text-2xl shadow-md">
                ğŸ‘¨â€ğŸ’¼</div>
            <h3 class="text-white font-bold text-sm">Quáº£n trá»‹ viÃªn</h3>
            <p class="text-white/60 text-[10px] font-black uppercase mt-1">Há»‡ thá»‘ng thÆ° viá»‡n</p>
        </div>

        <nav id="sidebarMenu" class="flex-1 overflow-y-auto no-scrollbar px-1">
            <div class="nav-item active" onclick="loadModule('dashboard', this)"><span>ğŸ“Š</span> Tá»•ng quan</div>
            <div class="nav-item" onclick="loadModule('users', this)"><span>ğŸ‘¥</span> Quáº£n lÃ½ ngÆ°á»i dÃ¹ng</div>
            <div class="nav-item" onclick="loadModule('books', this)"><span>ğŸ“š</span> Quáº£n lÃ½ sÃ¡ch</div>
            <div class="nav-item" onclick="loadModule('muontra', this)"><span>ğŸ“‹</span> Quáº£n lÃ½ mÆ°á»£n tráº£</div>
            <div class="nav-item" onclick="loadModule('overdue', this)"><span>â°</span> Cáº£nh bÃ¡o quÃ¡ háº¡n</div>
            <div class="nav-item" onclick="loadModule('logs', this)"><span>ğŸ“’</span> Nháº­t kÃ½ hoáº¡t Ä‘á»™ng</div>
            <div class="nav-item" onclick="loadModule('settings', this)"><span>âš™ï¸</span> CÃ i Ä‘áº·t tÃ i khoáº£n</div>
            <div class="nav-item" onclick="loadModule('backup', this)"><span>ğŸ’¾</span> Sao lÆ°u & KhÃ´i phá»¥c</div>
        </nav>

        <a href="index.html"
            class="mt-4 flex items-center justify-center gap-2 bg-slate-900 text-white p-4 rounded-2xl font-black text-xs hover:bg-red-500 transition-all shadow-lg uppercase tracking-widest">
            ÄÄƒng xuáº¥t ğŸšª
        </a>
    </aside>

    <main class="flex-1 p-10 main-vibrant-bg overflow-y-auto no-scrollbar">
        <header class="flex justify-between items-center mb-12">
            <div>
                <h2 id="moduleTitle" class="text-4xl font-black header-title tracking-tight">
                    Tá»•ng Quan Há»‡ Thá»‘ng
                </h2>
                <p class="text-slate-400 font-medium mt-1">ChÃ o má»«ng báº¡n trá»Ÿ láº¡i vá»›i báº£ng Ä‘iá»u hÃ nh.</p>
            </div>

            <button onclick="exportSystemReport()"
                class="bg-gradient-to-r from-orange-500 to-yellow-400 text-white px-8 py-4 rounded-2xl font-bold shadow-lg shadow-orange-200 hover:scale-105 transition-all">
                ğŸ“Š Xuáº¥t bÃ¡o cÃ¡o
            </button>
        </header>

        <div id="mainContent" class="animate-in fade-in duration-500">
        </div>
    </main>
    <script src="data.js"></script>
    <script src="https://unpkg.com/html5-qrcode@2.3.8/html5-qrcode.min.js"></script>
    <script src="./js/admin-controller/admin-router.js"></script> <!-- PHáº¢I TRÆ¯á»šC -->
    <script src="./js/admin-controller/dashboard.js"></script>
    <script src="./js/admin-controller/book-manager.js"></script>
    <script src="./js/admin-controller/user-manager.js"></script>
    <script src="./js/admin-controller/overdue-manager.js"></script>
    <script src="./js/admin-controller/activity-log.js"></script>
    <script src="./js/admin-controller/settings.js"></script>
    <script src="./js/admin-controller/backup-restore.js"></script>
    <script src="./js/admin-controller/loan-manager.js"></script>
    <!-- <script src="admin-modules.js"></script> -->
    <script>
        window.onload = () => {
            // Kiá»ƒm tra xem cÃ¡c file Ä‘Ã£ náº¡p thÃ nh cÃ´ng chÆ°a
            try {
                const db = getLibData();
                console.log("Dá»¯ liá»‡u Ä‘Ã£ sáºµn sÃ ng:", db);

                // KÃ­ch hoáº¡t module Dashboard
                if (typeof loadModule === 'function') {
                    loadModule('dashboard', document.querySelector('.nav-item.active'));
                }

                // KÃ­ch hoáº¡t Ä‘á»“ng bá»™ thá»i gian thá»±c
                if (typeof setupRealtimeSync === 'function') {
                    setupRealtimeSync((newData) => {
                        // Reload module hiá»‡n táº¡i
                        if (window.currentModule) {
                            const activeNav = document.querySelector('.nav-item.active');
                            loadModule(window.currentModule, activeNav);

                            // Náº¿u Ä‘ang á»Ÿ Dashboard, cáº­p nháº­t láº¡i cÃ¡c thá»‘ng kÃª
                            if (window.currentModule === 'dashboard' && typeof renderDashboard === 'function') {
                                renderDashboard(newData);
                            }
                        }
                    });
                }
            } catch (e) {
                console.error("Lá»—i há»‡ thá»‘ng: ", e.message);
                alert("Lá»—i: " + e.message + ". HÃ£y nháº¥n F12 Ä‘á»ƒ kiá»ƒm tra Console.");
            }
        };
    </script>
</body>

</html>